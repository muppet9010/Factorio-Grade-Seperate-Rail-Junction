Next:
    - A train exiting the tunnel can repath and decide to turn around and go back into the tunnel, for example if the player removes a piece of rail from the track leading away from the tunnel and there's another path to the next schedule destination. Needs to support a train being able to reverse while in the tunnel back out. The train should retain its station reservation if it can path to its target, as this is what happens to a double ended train in the a regular track segment if there is an alternatitve route to target. Only if the train can't reach the target at all does it pull to the end of the portal and then it can sit and no path. Automated test types:
        - Train types (heading west): <, <>, <-->, <>----, ----<>
        - Leaving track removed: before committed, once committed (full train still), as each carriage enters the tunnel, when train fully in tunnel, after each carriage leaves the tunnel, when the full trian has left the tunel.
    - Sync Utils to repo from this mod.

Soon:
    - Handle the target station or target track being removed while the train is in the tunnel. Currently Quality control state checks flag this as an error. Train should go on to the next order stop or if there is none just pull to the end of the portals entrance signals so its obvious thats its stopped.
    - Handle trains running out of fuel. Give them enough to get out of the tunnel entirely so the player can deal with.
    - Have to still handle when a train could try to reverse through a tunnel:
        - long train sticking out of both ends and stops due to path lost. The front/back segments could try to reverse as it's still in a dual direction rail segment on the tail end.
        - Player changes a committed entering trains order?
    - Test with train set to go to rail tile on other side of tunnel, not station. Don't believe it will work.
    - Player can rotate (R) a portal entity after placed and this breaks our inner logic. No reason for this to be possible, so try to just block it.
    - When tunnels are removed have their underground rails kept, track the removed spacings (id currently) for later reuse. Then allows them to be re-used by a future tunnel to save the entity creation and surface size creep. Need to move to tracking placed tunnels on horizontal/vertical and not just using their shared ID as offset to facilitate this. At present the underground tracks aren't trackable and so the removal code is commented out (tunnel.undergroundTunnel.railEntities).

Later:
    - Handle player driven trains approaching the tunnel (will go on auto through the tunnel). Put the player in a pushing train if needed when the train reaches other side.
    - Handle 2 trains both entering the tunnel at once.
    - Handle very very long trains:
        - Place rails under the underground train carriages if its a very long train, Currently 1000 tiles each side of tunnel hardcoded. Maybe default 1000 tiles runup is too long and is contributing to lag when making tunnel on large maps (track lag).
        - Confirm that if a train leaving is slowed and it is still entering that the entering train keeps in sync correctly. Should just work.
    - Handle trains being destroyed as they go in/come out of the tunnel.
    - Handle no driver/order trains that "coast" in to the tunnel due to being damaged or whatever. A train that can't power itself in this direction should be hard stopped at the tunnel entrance, otherwise treated like a player driven train.
    - Block train wagons being placed on invisible rails and on portals entrance track. Will have to do this via events and can't make placement invalid without blocking trains from crossing.
    - Handle a train that enters a second tunnel while leaving a first tunnel. Get by global trainID's tracked. Support N tunnels in use at once.
    - Check entering artillery trains stopped going in to the tunnel when the head has stopped coming out (signal). In vanialla an arty train not stopped at station or in manual won't fire.
    - Add tests for all of the situations that a carriage/train can be destroyed. Do late on as will be time consuming and need updating on other major changes. Also cover players in trains and when the carraiges, portals and tunnels are destroyed.
    - Look at merging the trainId tracking lists in to a single list with attributes for the "type". Low priority and just to make code neater: global.trainManager.enteringTrainIdToManagedTrain, global.trainManager.leavingTrainIdToManagedTrain, global.trainManager.trainLeftTunnelTrainIdToManagedTrain.

NICE TO HAVE:
    - Look at TSM and LTN compatibility requirement or block them.
    - Have a 6x6 tunnel segment that is for 2 tunnels crossing each other. Will need changes to tunnel complete checking logic. Don't think this can fast replace existing entities, or maybe should be just able to build tunnel segments against one another and this is a hndled configuration (needs solid across tunnel (3 pieces wide/long).
    - When you misplace a tunnel part use a render to show the valid spots to the player. As can be annoying to work out which axis is wrong.
    - When a tunnel part is placed invalidly and it is mined by the player/robot it shows the item being picked up. Need to return the item and remove the entity in a silent way. We show red warning text to the player already.
    - Proper Graphics: icons, ingame entities, placement entities.
    - Review what to allow to be built on top of the tunnel segments, either just belts or anything non trains. At present is nothing, but can be driven over.
    - When a tunnel is destroyed (by force) there will be a mod setting to drop the train and its contents on the ground at the portal ends. Carriages, fuel, cargo items, equipment grids.
    - Very very fast train mods may cause issues as they can move more than 15 tiles per tick, max speed is now 7386.3km/h or 34 tiles a tick. Either block or force to slow down for tunnels on approach?
    - Tunnel sections shouldn't collide with cliffs, but rail crossing sections should. Also check if cliff reshaping from adjacent cliff removal would destroy tunnels.
    - Look at if tunnel segments (not rail crossing ones) can be built under water. Should be same placement entity, just a differnet graphics entity on top to show the tunnel on the lake bed.
    - Look at if tiles can be placed over tunnel segments or something done to allow them to be paved over (even if just a visual).